<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <title>体检报告</title>
    <script src="/js/jquery-1.8.3.min.js"></script>
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/bootstrap-responsive.min.css"/>
    <script src="/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/bootstrap-theme.css"/>
    <script src="/js/npm.js"></script>
    <script src="/js/bootbox.min.js"></script>


</head>
<script type="text/javascript">
    $(function(){
        var choose=$("#content").html();
        $("option").each(function(){
            if($(this).html()==choose){
                $(this).prop("selected","selected");
                return;
            }
        });
        $("#goPage").click(function(){
            var pageno = $("#toGoPage").val();
            if(pageno == ""){
                window.location.href = "/registerController/findAll?pageno=1";
            }else if(0>=pageno){
                return;
            }else if($("#totalPage").html()>=pageno){
                window.location.href = "/registerController/findAll?pageno="+pageno;
            }else if(0>=$("#totalPage").html()){
                return;
            }else{
                return;
            }
        });
        $("#headPage").click(function(){
            window.location.href = "/examinationController/findAll?pageno=1";
        });
        $("#next").click(function(){

            var pageno =Number($("#nowpage").html())+1;
            if($("#totalPage").html()>=pageno){
                window.location.href = "/examinationController/findAll?pageno="+pageno;
            }else{
                return;
            }
        });
        $("#up").click(function(){

            var pageno =Number($("#nowpage").html())-1;
            if(pageno>=1){
                window.location.href = "/examinationController/findAll?pageno="+pageno;
            }else{
                return;
            }
        });
        $("#pageSize").change(function(){
            var pageSize = this.value;
            window.location.href = "/registerController/findAll?pageSize="+pageSize;
        });
        $("#export").click(function(){

            var result=confirm("确定上传？");
            if(result){
                $.ajax({
                    type : "GET",
                    url : "/examinationController/import",
                    data : "",
                    success:function(data){
                        if(data=="0"){
                            alert("文件所放路径不符合要求！");
                        }else if(data=="1"){
                            alert("无数据可添加！");
                        }else if(data=="2"){
                            alert("添加成功");
                            window.location.href="/examinationController/findAll";
                        }else if(data=="repeat"){
                            alert("存在已经录入过的数据，不过已帮你自动过滤！");
                            window.location.href="/examinationController/findAll";
                        }
                    }
                });
            }

        });
        $(".lookup").each(function(){
            $(this).click(function(){

                var idCard = $(this).parent().parent().children().eq(1).html();
                var check_date = $(this).parent().parent().children().eq(2).html();
                $.ajax({
                    type : "POST",
                    url : "/examinationController/findExaminationByIdCardAndCheckDate",
                    data :{"idCard":idCard,"check_date":check_date},
                    success : function(data) {
                        if(data == "true"){
                            window.location.href="/examinationController/lookDetails?mark="+1;
                        }
                    }
                });
            });
        });
    });
</script>
<body>
<div style="overflow: auto;height: 60px;border-bottom: 1px solid silver">
    <input type="button" value="上传" id="export" style="margin-top: 20px;width: 95px;" class="btn"/>
</div>
<table class="table table-striped">
    <thead>
    <tr>
        <th>序号</th><th>身份证号</th><th>时间</th><th>操作</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="examination:${examinations}">
        <td th:text="${examination.number}"></td>
        <td th:text="${examination.idCard}"></td>
        <td th:text="${examination.check_date}"></td>
        <td><a style="cursor:pointer;text-decoration: none" class="lookup">查看报告</a></td>
    </tr>
    </tbody>
</table>
<div class="pagination">

    <ul>
        <!--<li><a href="#">&laquo;</a></li>-->
        <li><a>共<span style="color:red;" th:text="${count}">1</span>条</a></li>
        <li><input type="number" id="toGoPage" style="width:50px;text-align:center;float:left" placeholder="页码"/></li>
        <li style="cursor:pointer;background-color: #3e8f3e"><a onclick="send()" id="goPage">跳转</a></li>
        <li style="cursor:pointer;"><a id="headPage">首页</a></li>
        <li style="cursor:pointer;"><a id="up">上页</a></li>
        <li><a><span style="color:#808080;" th:text="${currentPage}" id="nowpage"></span></a></li>
        <li style="cursor:pointer;"><a id="next">下页</a></li>
        <li><a>第<span th:text="${currentPage}">2</span>页</a></li>
        <li><a>共<span th:text="${totalPage}" id="totalPage">1</span>页</a></li>
        <li>
            <select title='显示条数' style="width:55px;float:left;" id="pageSize">
                <option th:text="5">5</option>
                <option th:text="10">10</option>
                <option th:text="15">15</option>
                <option th:text="20">20</option>
            </select><span th:text="${pageSize}" id="content" style="display: none"></span>
        </li>
    </ul>
</div>
</body>
</html>